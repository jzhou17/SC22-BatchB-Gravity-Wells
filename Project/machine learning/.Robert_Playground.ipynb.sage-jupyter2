{"backend_state":"init","connection_file":"/projects/39b268b1-0e75-4ebd-9cf2-691243b37f4a/.local/share/jupyter/runtime/kernel-facb3c06-a9ad-40f9-abe9-fbf8f6afd35f.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"021c3e","input":"","pos":13,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"1999eb","input":"RFR_test_predictions = RFR.predict(test_in)","pos":6,"type":"cell"}
{"cell_type":"code","exec_count":137,"id":"da3d0b","input":"import numpy as np\nimport pandas as pd\nimport plotly.express as px\nfrom sklearn import linear_model\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.ensemble import RandomForestRegressor","pos":1,"type":"cell"}
{"cell_type":"code","exec_count":138,"id":"c88e2d","input":"df = pd.read_csv('../data/emissions_clean.csv')\ndf","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Greenhouse Gas Emissions</th>\n      <th>Country</th>\n      <th>Year</th>\n      <th>Natural Gas Production</th>\n      <th>Crude Oil Production</th>\n      <th>Motor Gasoline Production</th>\n      <th>Gas Oil/Diesel Oil Production</th>\n      <th>Hard Coal Import</th>\n      <th>Natural Gas Import</th>\n      <th>Crude Oil Import</th>\n      <th>Motor Gasoline Import</th>\n      <th>Gas Oil/Diesel Oil Import</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.054706</td>\n      <td>AUS</td>\n      <td>0.000000</td>\n      <td>0.021426</td>\n      <td>0.042152</td>\n      <td>0.032485</td>\n      <td>0.035283</td>\n      <td>0.072573</td>\n      <td>0.160358</td>\n      <td>0.011185</td>\n      <td>0.025814</td>\n      <td>0.038504</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.054714</td>\n      <td>AUS</td>\n      <td>0.034483</td>\n      <td>0.022284</td>\n      <td>0.042097</td>\n      <td>0.032836</td>\n      <td>0.035291</td>\n      <td>0.072573</td>\n      <td>0.160358</td>\n      <td>0.011904</td>\n      <td>0.009431</td>\n      <td>0.017241</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.055211</td>\n      <td>AUS</td>\n      <td>0.068966</td>\n      <td>0.024255</td>\n      <td>0.036931</td>\n      <td>0.034309</td>\n      <td>0.035667</td>\n      <td>0.072573</td>\n      <td>0.160358</td>\n      <td>0.014780</td>\n      <td>0.003299</td>\n      <td>0.014544</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.055334</td>\n      <td>AUS</td>\n      <td>0.103448</td>\n      <td>0.026089</td>\n      <td>0.036145</td>\n      <td>0.035341</td>\n      <td>0.037777</td>\n      <td>0.072573</td>\n      <td>0.160358</td>\n      <td>0.019346</td>\n      <td>0.006243</td>\n      <td>0.025065</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.055399</td>\n      <td>AUS</td>\n      <td>0.137931</td>\n      <td>0.028112</td>\n      <td>0.033539</td>\n      <td>0.035350</td>\n      <td>0.039561</td>\n      <td>0.072573</td>\n      <td>0.160358</td>\n      <td>0.023570</td>\n      <td>0.006575</td>\n      <td>0.028469</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>811</th>\n      <td>0.895257</td>\n      <td>USA</td>\n      <td>0.862069</td>\n      <td>0.795903</td>\n      <td>0.768145</td>\n      <td>0.948502</td>\n      <td>0.973834</td>\n      <td>0.041179</td>\n      <td>0.586568</td>\n      <td>0.672627</td>\n      <td>0.688902</td>\n      <td>0.486185</td>\n    </tr>\n    <tr>\n      <th>812</th>\n      <td>0.874972</td>\n      <td>USA</td>\n      <td>0.896552</td>\n      <td>0.784212</td>\n      <td>0.725103</td>\n      <td>0.979561</td>\n      <td>0.945955</td>\n      <td>0.034993</td>\n      <td>0.648606</td>\n      <td>0.719131</td>\n      <td>0.715889</td>\n      <td>0.363777</td>\n    </tr>\n    <tr>\n      <th>813</th>\n      <td>0.869987</td>\n      <td>USA</td>\n      <td>0.931034</td>\n      <td>0.802166</td>\n      <td>0.763528</td>\n      <td>0.987205</td>\n      <td>0.969598</td>\n      <td>0.028567</td>\n      <td>0.656594</td>\n      <td>0.728370</td>\n      <td>0.648413</td>\n      <td>0.380492</td>\n    </tr>\n    <tr>\n      <th>814</th>\n      <td>0.895303</td>\n      <td>USA</td>\n      <td>0.965517</td>\n      <td>0.880516</td>\n      <td>0.897322</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>0.019493</td>\n      <td>0.622521</td>\n      <td>0.709856</td>\n      <td>0.690960</td>\n      <td>0.440189</td>\n    </tr>\n    <tr>\n      <th>815</th>\n      <td>0.880085</td>\n      <td>USA</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n      <td>0.979725</td>\n      <td>0.990327</td>\n      <td>0.021369</td>\n      <td>0.591345</td>\n      <td>0.621300</td>\n      <td>0.794523</td>\n      <td>0.483690</td>\n    </tr>\n  </tbody>\n</table>\n<p>816 rows × 12 columns</p>\n</div>","text/plain":"     Greenhouse Gas Emissions Country      Year  Natural Gas Production  \\\n0                    0.054706     AUS  0.000000                0.021426   \n1                    0.054714     AUS  0.034483                0.022284   \n2                    0.055211     AUS  0.068966                0.024255   \n3                    0.055334     AUS  0.103448                0.026089   \n4                    0.055399     AUS  0.137931                0.028112   \n..                        ...     ...       ...                     ...   \n811                  0.895257     USA  0.862069                0.795903   \n812                  0.874972     USA  0.896552                0.784212   \n813                  0.869987     USA  0.931034                0.802166   \n814                  0.895303     USA  0.965517                0.880516   \n815                  0.880085     USA  1.000000                1.000000   \n\n     Crude Oil Production  Motor Gasoline Production  \\\n0                0.042152                   0.032485   \n1                0.042097                   0.032836   \n2                0.036931                   0.034309   \n3                0.036145                   0.035341   \n4                0.033539                   0.035350   \n..                    ...                        ...   \n811              0.768145                   0.948502   \n812              0.725103                   0.979561   \n813              0.763528                   0.987205   \n814              0.897322                   1.000000   \n815              1.000000                   0.979725   \n\n     Gas Oil/Diesel Oil Production  Hard Coal Import  Natural Gas Import  \\\n0                         0.035283          0.072573            0.160358   \n1                         0.035291          0.072573            0.160358   \n2                         0.035667          0.072573            0.160358   \n3                         0.037777          0.072573            0.160358   \n4                         0.039561          0.072573            0.160358   \n..                             ...               ...                 ...   \n811                       0.973834          0.041179            0.586568   \n812                       0.945955          0.034993            0.648606   \n813                       0.969598          0.028567            0.656594   \n814                       1.000000          0.019493            0.622521   \n815                       0.990327          0.021369            0.591345   \n\n     Crude Oil Import  Motor Gasoline Import  Gas Oil/Diesel Oil Import  \n0            0.011185               0.025814                   0.038504  \n1            0.011904               0.009431                   0.017241  \n2            0.014780               0.003299                   0.014544  \n3            0.019346               0.006243                   0.025065  \n4            0.023570               0.006575                   0.028469  \n..                ...                    ...                        ...  \n811          0.672627               0.688902                   0.486185  \n812          0.719131               0.715889                   0.363777  \n813          0.728370               0.648413                   0.380492  \n814          0.709856               0.690960                   0.440189  \n815          0.621300               0.794523                   0.483690  \n\n[816 rows x 12 columns]"},"exec_count":138,"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"code","exec_count":139,"id":"db0116","input":"countries = df.pop('Country')\ndf = df.astype('float32')\ntarget = df.pop('Greenhouse Gas Emissions')\n","pos":3,"type":"cell"}
{"cell_type":"code","exec_count":147,"id":"b5501a","input":"train_in, test_in, train_out, test_out = train_test_split(df, target, test_size = 0.2, shuffle=True)","pos":4,"type":"cell"}
{"cell_type":"code","exec_count":148,"id":"44bd84","input":"RFR = RandomForestRegressor(150,min_samples_split=3)\nRFR.fit(train_in, train_out)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-48 {color: black;background-color: white;}#sk-container-id-48 pre{padding: 0;}#sk-container-id-48 div.sk-toggleable {background-color: white;}#sk-container-id-48 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-48 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-48 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-48 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-48 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-48 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-48 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-48 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-48 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-48 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-48 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-48 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-48 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-48 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-48 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-48 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-48 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-48 div.sk-item {position: relative;z-index: 1;}#sk-container-id-48 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-48 div.sk-item::before, #sk-container-id-48 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-48 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-48 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-48 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-48 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-48 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-48 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-48 div.sk-label-container {text-align: center;}#sk-container-id-48 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-48 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-48\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestRegressor(min_samples_split=3, n_estimators=150)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-96\" type=\"checkbox\" checked><label for=\"sk-estimator-id-96\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestRegressor</label><div class=\"sk-toggleable__content\"><pre>RandomForestRegressor(min_samples_split=3, n_estimators=150)</pre></div></div></div></div></div>","text/plain":"RandomForestRegressor(min_samples_split=3, n_estimators=150)"},"exec_count":148,"output_type":"execute_result"}},"pos":5,"type":"cell"}
{"cell_type":"code","exec_count":156,"id":"0c458e","input":"fig = px.scatter(y=test_out, x=RFR_test_predictions, labels={'x':'Predicted', 'y':'Actual'}, title = \"Random Forest Model\")\nfig.show()","output":{"0":{"data":{"iframe":"2c8fe1c85a243a3900f0df214373f5dd64efcb52"},"exec_count":156,"output_type":"execute_result"}},"pos":7,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":157,"id":"3a4ed2","input":"from sklearn.metrics import mean_squared_error, r2_score\nprint(mean_squared_error(test_out, RFR_test_predictions))\nr2_score(test_out, RFR_test_predictions)","output":{"0":{"name":"stdout","output_type":"stream","text":"1.5923507837249158e-05\n"},"1":{"data":{"text/plain":"0.9990686333670127"},"exec_count":157,"output_type":"execute_result"}},"pos":8,"type":"cell"}
{"cell_type":"code","exec_count":158,"id":"cb00e4","input":"from sklearn.neighbors import KNeighborsRegressor\nKNN = KNeighborsRegressor(n_neighbors=2, weights='distance')\nKNN.fit(train_in, train_out)","output":{"0":{"data":{"text/html":"<style>#sk-container-id-50 {color: black;background-color: white;}#sk-container-id-50 pre{padding: 0;}#sk-container-id-50 div.sk-toggleable {background-color: white;}#sk-container-id-50 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-50 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-50 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-50 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-50 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-50 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-50 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-50 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-50 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-50 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-50 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-50 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-50 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-50 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-50 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-50 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-50 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-50 div.sk-item {position: relative;z-index: 1;}#sk-container-id-50 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-50 div.sk-item::before, #sk-container-id-50 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-50 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-50 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-50 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-50 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-50 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-50 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-50 div.sk-label-container {text-align: center;}#sk-container-id-50 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-50 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-50\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsRegressor(n_neighbors=2, weights=&#x27;distance&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-98\" type=\"checkbox\" checked><label for=\"sk-estimator-id-98\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsRegressor</label><div class=\"sk-toggleable__content\"><pre>KNeighborsRegressor(n_neighbors=2, weights=&#x27;distance&#x27;)</pre></div></div></div></div></div>","text/plain":"KNeighborsRegressor(n_neighbors=2, weights='distance')"},"exec_count":158,"output_type":"execute_result"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":159,"id":"2472f4","input":"KNN_test_predictions = KNN.predict(test_in)\nfig = px.scatter(y=test_out, x=KNN_test_predictions, labels = {'y':'Actual','x':'Predicted'})\nfig.show()","output":{"0":{"data":{"iframe":"ed453d6877fbc281edcd64554964ef23a191f18d"},"exec_count":159,"output_type":"execute_result"}},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":160,"id":"f6891c","input":"print(mean_squared_error(test_out, KNN_test_predictions))\nr2_score(test_out, KNN_test_predictions)","output":{"0":{"name":"stdout","output_type":"stream","text":"6.088790692236671e-05\n"},"1":{"data":{"text/plain":"0.996438663802"},"exec_count":160,"output_type":"execute_result"}},"pos":12,"type":"cell"}
{"cell_type":"markdown","id":"28b4fc","input":"#### RFR\n\nParams: RFR = RandomForestRegressor\\(n\\_estimators = 150, min\\_samples\\_split = 3\\)\n\nMSE: 1.5923507837249158e\\-05\n\nR^2: 0.9990686333670127\n\n#### KNN\n\nParams: KNN = KNeighborsRegressor\\(n\\_neighbors=2, weights='distance'\\)\n\nMSE: 6.088790692236671e\\-05\n\nR^2: 0.996438663802\n\n","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"985897","input":"##### This is the end of RFR, now for KNN\n\n","pos":9,"type":"cell"}
{"id":0,"time":1657563957933,"type":"user"}
{"last_load":1657553974566,"type":"file"}